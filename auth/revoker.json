{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://www.krakend.io/schema/auth/revoker.json",
    "title": "The API Gateway authorizes users that provide valid tokens according to your criteria, but at some point, you might want to change your mind and decide to revoke JWT tokens that are still valid.",
    "type": "object",
    "additionalProperties": false,
    "patternProperties": {
        "^[@$_#]": {}
    },
    "required": [
        "N",
        "P",
        "hash_name",
        "TTL",
        "port",
        "token_keys"
    ],
    "properties": {
        "N": {
            "$id": "#auth/revoker/N",
            "title": "Bot detector",
            "description": "The maximum number of elements that you want to keep in memory (you can keep millions at a very low cost).\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "integer",
            "examples": [
                10000000
            ],
            "default": 10000000
        },
        "P": {
            "$id": "#auth/revoker/P",
            "title": "Probability",
            "description": "The probability of returning a false positive. E.g: 0.0000001\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "number",
            "examples": [
                0.0000001
            ],
            "default": 0.0000001
        },
        "hash_name": {
            "$id": "#auth/revoker/hash_name",
            "title": "Hash function name",
            "description": "The hash name used. Possible values are  'optimal' (recommended) or 'default'.\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "string",
            "default": "optimal",
            "enum": [
                "optimal",
                "default"
            ]
        },
        "TTL": {
            "$id": "#auth/revoker/TTL",
            "title": "Time To Live",
            "description": "The lifespan of the JWT you are generating, in seconds. The value must match the expiration you are setting in the backend.\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "integer",
            "default": 1500
        },
        "port": {
            "$id": "#auth/revoker/port",
            "title": "Port",
            "description": "The port number exposed (has to be free) for the RPC service to communicate with the bloomfilter.\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "integer",
            "default": 1234
        },
        "token_keys": {
            "$id": "#auth/revoker/token_keys",
            "title": "Token keys",
            "description": "The list with all the fields in your JWT payload that need watching. These fields establish the criteria to revoke accesses in the future.\n\nSee: https://www.krakend.io/docs/authorization/revoking-tokens/",
            "type": "array",
            "examples": [
                "jti"
            ]
        },
        "revoke_server_max_workers": {
            "$id": "#auth/revoker/revoke_server_max_workers",
            "title": "Max workers",
            "description": "How many workers are used concurrently to execute an action (e.g., push a token) to all registered instances, allowing you to limit the amount of memory consumed by the server. For example, if you have 100 KrakenD servers and need to push 5MB of data each, you need to send 500MB in total. A max_workers=5 will consume a maximum of `5MB x 5 workers = 25MB` of memory in a given instant. Defaults to the same number of CPUs available.\n\nSee: https://www.krakend.io/docs/enterprise/authentication/revoke-server/",
            "type": "integer",
            "default": 5
        },
        "revoke_server_ping_interval": {
            "$id": "#auth/revoker/revoke_server_ping_interval",
            "title": "Revoke Server ping interval",
            "description": "Time the server and the client wait to verify they are alive with each other (health check). Defaults to `30s`. Do not lower this value a lot; otherwise, you will have a lot of internal traffic.\n\nSee: https://www.krakend.io/docs/enterprise/authentication/revoke-server/",
            "type": "string",
            "$ref": "../timeunits.json#/$defs/timeunit",
            "examples": [
                "30s"
            ]
        },
        "revoke_server_ping_url": {
            "$id": "#auth/revoker/revoke_server_ping_url",
            "title": "Revoke Server Ping URL",
            "description": "The address to the `/instances` endpoint in the Revoke Server.\n\nSee: https://www.krakend.io/docs/enterprise/authentication/revoke-server/",
            "type": "string",
            "examples": [
                "http://revoke-server:8081/instances"
            ]
        },
        "revoke_server_api_key": {
            "$id": "#auth/revoker/revoke_server_api_key",
            "title": "Revoke Server Ping URL",
            "description": "A string used as an exchange API key to secure the communication between the Revoke Server and the KrakenD instances and to consume the REST API of the Revoker Server as well. E.g., a string generated with `uuidgen`.\n\nSee: https://www.krakend.io/docs/enterprise/authentication/revoke-server/",
            "type": "string",
            "examples": [
                "639ee23f-f4c5-40c4-855c-912bf01fae87"
            ]
        }
    }
}